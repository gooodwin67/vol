import{B as d,M as k,a as c,A,D as E,H as F,b as g,S as H,V as w,c as q,C as I,P as Q,d as V,W,O as K,e as _}from"./three-BZ2nwAgC.js";import{O as r}from"./@dimforge-D3Mqfikn.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();function v(a,e){return Math.random()*(e-a)+a}class x{constructor(e,t,o,i,s,p){this.scene=e,this.ballClass=t,this.worldClass=o,this.playersData=i,this.playerSpeed=s,this.playerThinkSpeed=p,this.playerHeight=1.4,this.playerGeometry=new d(.5,this.playerHeight,.5),this.playerMaterial=new k({color:43520}),this.player=new c(this.playerGeometry,this.playerMaterial),this.player.position.set(0,.5,5),this.player.castShadow=!0}}class U{constructor(e){this.ambientLight=new A(11184810,1),this.dirLight=new E(16777215,2),this.dirLight.position.set(0,10,-2),this.dirLight.castShadow=!0,this.hemiLight=new F(16777215,16777215,2),this.hemiLight.color.setHSL(.6,1,.6),this.hemiLight.groundColor.setHSL(.095,1,.75),this.hemiLight.position.set(0,100,0),this.scene=e,this.widthPlane=8,this.heightPlane=16,this.eventQueue,this.geometryPlane=new d(this.widthPlane,.2,this.heightPlane),this.materialPlane=new k({color:11184810}),this.plane=new c(this.geometryPlane,this.materialPlane),this.plane.receiveShadow=!0,this.plane.position.set(0,0,0),this.net=new c(new d(2,.2,this.widthPlane),new g({color:11184810,transparent:!0,opacity:.3})),this.net.position.set(0,1,0),this.net.rotation.x=Math.PI/2,this.net.rotation.y=Math.PI/2,this.gravity=-9.81,this.powerBlockWidth=0}}class j{constructor(e){this.ballGeometry=new H(.2,16,16),this.ballMaterial=new k({color:170}),this.ball=new c(this.ballGeometry,this.ballMaterial),this.ball.position.z=-2,this.ball.position.y=8.4,this.ball.castShadow=!0,this.ballMarkGeometry=new d(.2,.1,.2),this.ballMarkMaterial=new k({color:11141120,transparent:!0,opacity:.6}),this.ballMark=new c(this.ballMarkGeometry,this.ballMarkMaterial),this.ballMark.position.y=.1,this.ballMark.position.z=1,this.ballMark2Geometry=new d(.4,.1,.4),this.ballMark2Material=new k({color:11141120,transparent:!0,opacity:.6}),this.ballMarkOnGround=new c(this.ballMark2Geometry,this.ballMark2Material),this.ballMarkOnGround.position.y=.1,this.ballMarkOnGround.position.z=-2,this.ballBody,this.ballSideMe=!1,this.ballMarkSideMe=!1}}class N{constructor(e,t,o){this.scene=e,this.ballClass=t,this.worldClass=o,this.opponentHeight=1.4,this.opponentGeometry=new d(.5,this.opponentHeight,.5),this.opponentMaterial=new k({color:43520}),this.opponent=new c(this.opponentGeometry,this.opponentMaterial),this.opponent.position.set(0,.5,-5),this.opponent.castShadow=!0}}class J{constructor(){this.playerHeight=1.4,this.playerTopGeometry=new d(1.5,.1,1.5),this.playerTopMaterial=new g({color:11184640,transparent:!0,opacity:0}),this.playerTop=new c(this.playerTopGeometry,this.playerTopMaterial),this.playerTop.position.set(0,0,0),this.playerMarkGeometry=new d(.3,.1,.3),this.playerMarkMaterial=new g({color:21930}),this.playerMark=new c(this.playerMarkGeometry,this.playerMarkMaterial),this.playerMark.position.set(0,this.playerHeight/2+.8,0),this.playerShootMarkGeometry=new d(.2,.2,.2),this.playerShootMarkMaterial=new g({color:16733610,transparent:!0,opacity:!1}),this.playerShootMark=new c(this.playerShootMarkGeometry,this.playerShootMarkMaterial),this.playerShootMark.position.set(0,this.playerHeight*2.4,0),this.players=[],this.activePlayerNum=0,this.playerBodies=[],this.playerTapPas=!1,this.playerCanPas=!0,this.playerNowPas=!1,this.playerTapShoot=!1,this.playerFly=!1,this.playerTopBody=0,this.ballPlayerCollision=!1,this.opponentTopGeometry=new d(2,.1,2),this.opponentTopMaterial=new g({color:11184640,transparent:!0,opacity:!1}),this.opponentTop=new c(this.opponentTopGeometry,this.opponentTopMaterial),this.opponentTop.position.set(0,0,0),this.opponentShootMarkGeometry=new d(.2,.2,.2),this.opponentShootMarkMaterial=new g({color:16733610,transparent:!0,opacity:!1}),this.opponentShootMark=new c(this.opponentShootMarkGeometry,this.opponentShootMarkMaterial),this.opponentShootMark.position.set(0,this.playerHeight*2.4,0),this.opponentTopBody=0,this.opponentSpeed=.06,this.opponentThinkSpeed=.1,this.opponentActive=!0,this.activeOpponentNum=0,this.opponents=[],this.opponentBodies=[],this.opponentsSpeed=[.09,.09],this.opponentsPas=!1,this.opponentFly=!1,this.opponentTapShoot=!1,this.opponentsIter=0,this.ballOpponentCollision=!1}}class X{constructor(e,t,o,i){this.scene=e,this.ballClass=t,this.worldClass=o,this.playersData=i,this.forward=!1,this.backward=!1,this.left=!1,this.right=!1,this.xx=0,this.zz=0,addEventListener("keydown",s=>{switch(s.key){case"ArrowUp":this.forward=!0;break;case"ArrowLeft":this.left=!0;break;case"ArrowDown":this.backward=!0;break;case"ArrowRight":this.right=!0;break;case"s":case"\u044B":this.playersData.playerTapPas=!0,this.xx=0,this.zz=0;break;case"r":t.ballBody.setLinvel({x:0,y:0,z:0},!0),t.ballBody.setAngvel({x:0,y:0,z:0},!0),t.ballBody.setTranslation({x:0,y:4.4,z:4},!0),t.ballBody.applyImpulse({x:0,y:3,z:0},!0);break;case"\u0439":case"q":this.playersData.activePlayerNum==0?this.playersData.activePlayerNum=1:this.playersData.activePlayerNum=0;break;case"\u0432":case"d":this.xx=0,this.zz=0,this.playersData.playerTapShoot=!0;break}}),addEventListener("keyup",s=>{switch(s.key){case"ArrowUp":this.forward=!1;break;case"ArrowLeft":this.left=!1;break;case"ArrowDown":this.backward=!1;break;case"ArrowRight":this.right=!1;break;case"s":case"\u044B":this.playersData.playerTapPas=!1;break;case"\u0432":case"d":this.playersData.playerTapShoot=!1;break}})}movePlayer(){let e=this.ballClass,t=this.playersData,o=this.worldClass;e.ball.position.z>0?e.ballSideMe=!0:e.ballSideMe=!1;let i=this.playersData.players[this.playersData.activePlayerNum].player.position.y+1.3;if(this.ballClass.ball.position.y<i&&!this.playersData.playerTapShoot&&(i=this.ballClass.ball.position.y),this.playersData.playerTopBody.setNextKinematicTranslation({x:this.playersData.players[this.playersData.activePlayerNum].player.position.x,y:i,z:this.playersData.players[this.playersData.activePlayerNum].player.position.z},!0),this.playersData.playerTapShoot||this.playersData.playerBodies[this.playersData.activePlayerNum].setTranslation({x:this.playersData.playerBodies[this.playersData.activePlayerNum].translation().x+this.xx,y:this.playersData.playerBodies[this.playersData.activePlayerNum].translation().y,z:this.playersData.playerBodies[this.playersData.activePlayerNum].translation().z+this.zz},!0),this.forward?!this.playersData.playerTapPas&&!this.playersData.playerTapShoot?this.zz=-this.playersData.players[this.playersData.activePlayerNum].playerSpeed:this.ballClass.ballMark.position.z-=this.playersData.players[this.playersData.activePlayerNum].playerThinkSpeed:this.backward?!this.playersData.playerTapPas&&!this.playersData.playerTapShoot?this.zz=this.playersData.players[this.playersData.activePlayerNum].playerSpeed:this.ballClass.ballMark.position.z+=this.playersData.players[this.playersData.activePlayerNum].playerThinkSpeed:this.zz=0,this.left?!this.playersData.playerTapPas&&!this.playersData.playerTapShoot?this.xx=-this.playersData.players[this.playersData.activePlayerNum].playerSpeed:this.ballClass.ballMark.position.x-=this.playersData.players[this.playersData.activePlayerNum].playerThinkSpeed:this.right?!this.playersData.playerTapPas&&!this.playersData.playerTapShoot?this.xx=this.playersData.players[this.playersData.activePlayerNum].playerSpeed:this.ballClass.ballMark.position.x+=this.playersData.players[this.playersData.activePlayerNum].playerThinkSpeed:this.xx=0,t.playerMark.position.x=t.players[t.activePlayerNum].player.position.x,t.playerMark.position.z=t.players[t.activePlayerNum].player.position.z,t.playerShootMark.position.x=t.players[t.activePlayerNum].player.position.x,t.playerShootMark.position.z=t.players[t.activePlayerNum].player.position.z,t.ballPlayerCollision=!1,t.ballOpponentCollision=!1,o.eventQueue.drainCollisionEvents((s,p,m)=>{p==e.ballBody.handle&&s==0&&(t.ballPlayerCollision=!0),p==e.ballBody.handle&&s=="1.5e-323"&&m&&(t.ballOpponentCollision=!0),s==e.ballBody.handle&&p=="3.5e-323"&&console.log("\u0413\u041E\u041E\u041E\u041B")}),t.playerTop.position.distanceTo(e.ball.position)>1&&(t.playerCanPas=!0),t.playerCanPas&&t.ballPlayerCollision&&t.playerBodies[t.activePlayerNum].translation().y<1){const s=e.ballMark.position;this.shootEngine(3,.45,s),t.opponents[0].opponent.position.distanceTo(e.ballMarkOnGround.position)<t.opponents[1].opponent.position.distanceTo(e.ballMarkOnGround.position)?t.activeOpponentNum=0:t.activeOpponentNum=1,t.players[0].player.position.distanceTo(e.ball.position)>t.players[1].player.position.distanceTo(e.ball.position)?t.activePlayerNum=0:t.activePlayerNum=1,t.playerCanPas=!1}if(e.ball.position.distanceTo(t.playerShootMark.position)<2&&t.playerTapShoot&&!t.playerFly&&t.playerBodies[t.activePlayerNum].applyImpulse({x:0,y:5.2,z:0},!0),t.playerBodies[t.activePlayerNum].translation().y>=t.playerHeight/1.5&&(t.playerFly=!0),t.playerBodies[t.activePlayerNum].translation().y<t.playerHeight/1.5&&(t.playerFly=!1),t.ballPlayerCollision&&t.playerBodies[t.activePlayerNum].translation().y>1){const s=e.ballMark.position;this.shootEngine(.05,.1,s),t.opponents[0].opponent.position.distanceTo(e.ballMarkOnGround.position)<t.opponents[1].opponent.position.distanceTo(e.ballMarkOnGround.position)?t.activeOpponentNum=0:t.activeOpponentNum=1}if(this.playersData.playerTapPas&&e.ballMark.position.z>0){const s=t.playerBodies[1-t.activePlayerNum],p=t.players[1-t.activePlayerNum].player,m=new w;if(m.subVectors(new w(e.ballMark.position.x,p.position.y,e.ballMark.position.z),p.position).normalize(),Math.sqrt(Math.pow(p.position.x-e.ballMark.position.x,2)+Math.pow(p.position.z-e.ballMark.position.z,2))>.5){const D=m.clone().multiplyScalar(t.players[1-t.activePlayerNum].playerSpeed/2.5);p.position.z>e.ballMark.position.z&&s.setTranslation({x:p.position.x+D.x,y:p.position.y,z:p.position.z+D.z},!0)}}}moveOpponent(){let e=this.ballClass,t=this.playersData,o=this.worldClass;t.opponentShootMark.position.x=t.opponents[t.activeOpponentNum].opponent.position.x,t.opponentShootMark.position.z=t.opponents[t.activeOpponentNum].opponent.position.z;let i=t.opponents[t.activeOpponentNum].opponent.position.y+1.3;if(e.ball.position.y<i&&(i=e.ball.position.y),this.playersData.opponentTopBody.setNextKinematicTranslation({x:t.opponents[t.activeOpponentNum].opponent.position.x,y:i,z:t.opponents[t.activeOpponentNum].opponent.position.z},!0),e.ballMarkOnGround.position.z<0){const s=new w;if(s.subVectors(new w(e.ballMarkOnGround.position.x,t.opponents[t.activeOpponentNum].opponent.position.y,e.ballMarkOnGround.position.z+.2),t.opponents[t.activeOpponentNum].opponent.position).normalize(),Math.sqrt(Math.pow(t.opponents[t.activeOpponentNum].opponent.position.x-e.ballMarkOnGround.position.x,2)+Math.pow(t.opponents[t.activeOpponentNum].opponent.position.z-e.ballMarkOnGround.position.z,2))>.5){const p=t.opponentBodies[t.activeOpponentNum],m=s.clone().multiplyScalar(t.opponentsSpeed[t.activeOpponentNum]);p.setTranslation({x:p.translation().x+m.x,y:p.translation().y,z:p.translation().z+m.z},!0)}}if(t.ballOpponentCollision&&!t.opponentsPas&&!t.opponentTapShoot){let s;t.opponentsIter++,t.opponentsIter<3?s=new w(v(-o.widthPlane/2,o.widthPlane/2),0,v(-o.heightPlane/2,0)):(s=new w(v(-o.widthPlane/2,o.widthPlane/2),0,v(4,o.heightPlane/2)),t.opponentsIter=0),t.opponentTapShoot||this.shootEngine(3,.45,s),t.activeOpponentNum=1-t.activeOpponentNum,e.ballMarkOnGround.position.z>0&&(t.players[0].player.position.distanceTo(e.ballMarkOnGround.position)<t.players[1].player.position.distanceTo(e.ballMarkOnGround.position)?t.activePlayerNum=0:t.activePlayerNum=1),e.ballMark.position.copy(t.players[t.activePlayerNum].player.position),e.ballMark.position.y=.1,t.opponentsPas=!0}else t.opponentTop.position.distanceTo(e.ball.position)>1.1&&(t.opponentsPas=!1);if(t.opponents[t.activeOpponentNum].opponent.position.z>-2?t.opponentTapShoot=!0:t.opponentTapShoot=!1,e.ball.position.distanceTo(t.opponentShootMark.position)<2&&t.opponentTapShoot&&!t.opponentFly&&t.opponentBodies[t.activeOpponentNum].applyImpulse({x:0,y:5.2,z:0},!0),t.opponentBodies[t.activeOpponentNum].translation().y>=t.playerHeight/1.5&&(t.opponentFly=!0),t.opponentBodies[t.activeOpponentNum].translation().y<t.playerHeight/1.5&&(t.opponentFly=!1),t.ballOpponentCollision&&t.opponentFly){const s=new w(v(-o.widthPlane/2,o.widthPlane/2),0,v(4,o.heightPlane/2));this.shootEngine(.05,.1,s),t.opponentsIter=0,e.ballMarkOnGround.position.z>0&&(t.players[0].player.position.distanceTo(e.ballMarkOnGround.position)<t.players[1].player.position.distanceTo(e.ballMarkOnGround.position)?t.activePlayerNum=0:t.activePlayerNum=1)}}shootEngine(e,t,o){let i=this.ballClass;this.playersData;let s=this.worldClass;const p=i.ballBody.translation();i.ballBody.setLinvel({x:0,y:0,z:0},!0),i.ballBody.setAngvel({x:0,y:0,z:0},!0);const m=o.x-p.x,D=o.z-p.z,S=Math.sqrt(2*e/Math.abs(s.gravity)),B=m/S*t,G=D/S*t,L=Math.sqrt(2*Math.abs(s.gravity)*e),R={x:B,y:L,z:G};i.ballMarkOnGround.position.copy(o),i.ballMarkOnGround.position.y=.2,i.ballBody.setLinvel({x:0,y:0,z:0},!0),i.ballBody.setAngvel({x:0,y:0,z:0},!0),i.ballBody.applyImpulse(R,!0)}}console.clear();const l=new q;l.background=new I(14479094);const T=new Q(75,window.innerWidth/window.innerHeight,.1,1e3);T.position.set(0,9,11);let O=new V;document.body.appendChild(O.dom);const P=new W;P.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(P.domElement),P.shadowMap.enabled=!0;let C=new K(T,P.domElement);C.enableDamping=!0,C.target.set(0,0,0);let f=!1,h,u=[],y,n,b,z;document.querySelector(".power_block"),document.querySelector(".power_wrap");async function Y(){y=new U,n=new J,b=new j(l);let a=new N(l,b,y,n),e=new N(l,b,y,n);n.opponents.push(a,e);let t=new x(l,b,y,n,.07,.2);t.player.position.x-=2;let o=new x(l,b,y,n,.07,.2);o.player.position.x=2,n.players.push(t,o),z=new X(l,b,y,n)}async function Z(){l.add(y.ambientLight),l.add(y.dirLight),l.add(y.plane),l.add(y.net),l.add(b.ball),l.add(b.ballMark),l.add(b.ballMarkOnGround),l.add(n.players[0].player),l.add(n.players[1].player),l.add(n.playerTop),l.add(n.playerMark),l.add(n.playerShootMark),l.add(n.opponents[0].opponent),l.add(n.opponents[1].opponent),l.add(n.opponentTop),l.add(n.opponentShootMark)}async function $(){await r.init(),h=new r.World(new r.Vector3(0,y.gravity,0)),y.eventQueue=new r.EventQueue(!0),M(n.playerTop,"player"),n.players.forEach((a,e,t)=>{M(a.player,"playerMain")}),M(n.opponentTop,"opponent"),n.opponents.forEach((a,e,t)=>{M(a.opponent,"opponentMain")}),M(b.ball,"ball"),M(y.plane,"plane"),M(y.net,"plane6")}async function tt(){await Y(),await Z(),await $(),f=!0}tt();function et(){if(f){z.movePlayer(),z.moveOpponent();for(let a=0,e=u.length;a<e;a++)u[a][0].position.copy(u[a][1].translation()),u[a][0].quaternion.copy(u[a][1].rotation());h.step(y.eventQueue),O.update(),P.render(l,T)}}P.setAnimationLoop(et);function M(a,e){const t=a.rotation.clone();a.rotation.set(0,0,0);const o=new _().setFromObject(a).getSize(new w);if(a.rotation.copy(t),e=="player"){const i=h.createRigidBody(r.RigidBodyDesc.kinematicPositionBased().setTranslation(a.position.x,a.position.y,a.position.z).setRotation(a.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),s=r.ColliderDesc.cuboid(o.x/2,o.y/2,o.z/2).setMass(1).setRestitution(.5).setFriction(0).setSensor(!0);n.playerTopBody=i,h.createCollider(s,i),u.push([a,i,a.id])}if(e=="playerMain"){const i=h.createRigidBody(r.RigidBodyDesc.dynamic().setTranslation(a.position.x,a.position.y,a.position.z).setRotation(a.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(0)),s=r.ColliderDesc.cuboid(o.x/2,o.y/2,o.z/2).setMass(10).setRestitution(.5).setFriction(5);n.playerBodies.push(i),h.createCollider(s,i),u.push([a,i,a.id])}else if(e=="opponent"){const i=h.createRigidBody(r.RigidBodyDesc.kinematicPositionBased().setTranslation(a.position.x,a.position.y,a.position.z).setRotation(a.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),s=r.ColliderDesc.cuboid(o.x/2,o.y/2,o.z/2).setMass(1).setRestitution(.5).setFriction(0).setSensor(!0);n.opponentTopBody=i,console.log(i.handle),h.createCollider(s,i),u.push([a,i,a.id])}if(e=="opponentMain"){const i=h.createRigidBody(r.RigidBodyDesc.dynamic().setTranslation(a.position.x,a.position.y,a.position.z).setRotation(a.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(0)),s=r.ColliderDesc.cuboid(o.x/2,o.y/2,o.z/2).setMass(10).setRestitution(.5).setFriction(5);n.opponentBodies.push(i),h.createCollider(s,i),u.push([a,i,a.id])}else if(e=="ball"){const i=h.createRigidBody(r.RigidBodyDesc.dynamic().setTranslation(a.position.x,a.position.y,a.position.z).setRotation(a.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),s=r.ColliderDesc.ball(o.z/2).setMass(1).setRestitution(1).setFriction(0);s.setActiveEvents(r.ActiveEvents.COLLISION_EVENTS),b.ballBody=i,h.createCollider(s,i),u.push([a,i,a.id])}else if(e.includes("plane")){const i=h.createRigidBody(r.RigidBodyDesc.fixed().setTranslation(a.position.x,a.position.y,a.position.z).setRotation(a.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),s=r.ColliderDesc.cuboid(o.x/2,o.y/2,o.z/2).setMass(1).setRestitution(0).setFriction(.1);h.createCollider(s,i),u.push([a,i,a.id])}}
